<!DOCTYPE html>
<html th:replace="~{layout :: layout (~{::title}, ~{::main}, ~{::styles}, ~{::scripts})}">

<th:block th:fragment="styles">
  <link rel="stylesheet" th:href="@{/plugins/select2/css/select2.min.css}">
  <link rel="stylesheet" th:href="@{/plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css}">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</th:block>


<head>
  <title>[[${vendas.id == null ? 'Novo' : 'Editar'}]] Vendas</title>
</head>

<body>
  <main>
    <div class="row">
      <div class="col-sm-12">
        <form method="POST" action="/vendas/cadastrar" th:object="${vendas}" enctype="multipart/form-data"
          id="mainForm">
          <div class="card">

            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <div class="card-body">
              <fieldset>
                <legend>Dados da Venda</legend>

                <input type="hidden" th:field="*{id}">

                <div class="form-container row">

                  <div class="col-sm-6">
                    <div class="form-group">
                      <label for="numero">Número</label>
                      <input type="number" class="form-control" th:field="*{numero}" placeholder="Número da Venda">
                    </div>

                    <div class="form-group">
                      <label for="dataVenda">Data da Venda</label>
                      <input type="date" class="form-control" th:field="*{dataVenda}" placeholder="Data da Venda">
                    </div>

                    <div class="form-group">
                      <label for="quantidade">Quantidade de Pedidos</label>
                      <input type="number" class="form-control" id="quantidade" placeholder="Quantidade de Pedidos">
                    </div>
                    <div id="lanche">
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="formaPagamento">Forma de Pagamento</label>
                    <select th:field="*{formaPagamento}" class="form-control">
                      <option value="">Selecione a Forma de Pagamento</option>
                      <option value="">Cartão de Crédito</option>
                      <option value="">Dinheiro</option>
                      <option value="">Pix</option>
                      <option th:each="formaPagamento : ${formaPagamento}" th:value="${formaPagamento}"
                        th:text="${formaPagamento}"></option>
                    </select>
                  </div>

                  <div id="lanche">
                  </div>
                  <span>Valor Total: R$ <span id="valorTotal">0.00</span></span>
                  
                  
                  </div>

                  
                </div>
            </div>
          </div>
      </div>
    </div>
    <div class="card">
      <button type="submit" form="mainForm" class="btn btn-primary">Salvar</button>
    </div>
  </main>

  <th:block th:fragment="scripts">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/date-fns/2.22.1/date_fns.min.js"></script>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/date-fns/2.22.1/date_fns.min.js"></script>


    <style>
      .ui-autocomplete {
        background-color: white;
        border: 1px solid #ccc;
        padding: 10px;
        width: 300px;
        max-height: 400px;
        overflow-y: auto;
      }

      .ui-menu-item {
        padding: 5px 10px;
      }

      .ui-menu-item:hover {
        background-color: #f0f0f0;
      }
    </style>

    <script>
      $(document).ready(function () {
        $("#quantidade").on("input", function () {
          var quantidade = parseInt($(this).val());
          var lanche = $("#lanche");

          lanche.empty();

          if (!isNaN(quantidade) && quantidade > 0) {
            for (var i = 0; i < quantidade; i++) {
              lanche.append('<div class="form-group"><label for="lanche' + i + '">Lanche ' + (i + 1) + '</label><select class="form-control" id="lanche' + i + '" name="lanches[' + i + ']"><option value="">Selecione o lanche</option><option value="Lanche 1" data-price="1.50" >Café</option><option value="Lanche 2" data-price="1.50">Cachorro-Quente</option><option value="Lanche 3" data-price="1.50">Pão com Carne</option><option value="Lanche 4" data-price="1.50">Pão com Frango</option></select></div>');
            }
          }
        });
      });
    </script>

    <script>
      $(function () {
        $(document)
          .on("click", ".btn-add", function (e) {
            e.preventDefault();

            var controlForm = $(".controls:first"),
              currentEntry = $(this).parents(".entry:first"),
              newEntry = $(currentEntry.clone()).appendTo(controlForm);

            newEntry.find("input").val("");
            controlForm
              .find(".entry:not(:last) .btn-add")
              .removeClass("btn-add")
              .addClass("btn-remove")
              .removeClass("btn-success")
              .addClass("btn-danger")
              .html('<span class="fa fa-trash"></span>');
          })
          .on("click", ".btn-remove", function (e) {
            $(this).parents(".entry:first").remove();

            e.preventDefault();
            return false;
          });
      });
    </script>
  </th:block>
</body>

</html>